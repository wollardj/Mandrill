<template name="repo">
<div class="mandrill-header">
    <h2>Munki Repo</h2>
</div>


{{>repo_toolbar}}

<hr />

<div class="container-fluid">

    <div class="{{#if readme}}col-lg-8{{/if}}{{#unless readme}}col-xs-12{{/unless}}">

        <ol class="breadcrumb text-nowrap" style="overflow: auto">
        {{#each breadcrumb}}
            <li class="{{#if is_active}}active{{/if}}">
                {{#if is_active}}
                    {{name}}
                    <span class="badge">{{session_get 'results_length'}}</span>
                {{/if}}
                {{#unless is_active}}
                <a href="{{url}}">{{name}}</a>
                {{/unless}}
            </li>
        {{/each}}
        </ol>

        <div class="list-group">
            {{#each dir_listing}}
            <a href="{{url}}" class="list-group-item has-delete-button">
                <div class="row">
                    <div class="col-sm-4 col-xs-8">
                        {{#unless is_protected}}
                        <a
                            href="#"
                            class="
                                mandrill-repo-delete
                                {{#if session_get 'repo_edit_mode'}}
                                    mandrill-repo-delete-visible
                                {{/if}}"
                        >
                            Delete
                        </a>
                        {{/unless}}
                        {{#unless is_leaf}}
                        <i class="fa fa-folder text-info"></i>
                        {{/unless}}
                        {{#if is_leaf}}
                            {{#if pkgsinfo_icon}}
                                <img
                                    src="{{pkgsinfo_icon}}"
                                    class="repo_pkgicon" />
                            {{/if}}
                            {{#unless pkgsinfo_icon}}
                                <i class="fa fa-file"></i>
                            {{/unless}}
                        {{/if}}
                        {{name}}
                        {{#if this.dom.display_name}}
                        <span class="text-muted">
                            - {{this.dom.display_name}}
                        </span>
                        {{/if}}
                    </div>


                    <div class="col-sm-4 hidden-xs">
                        {{#if is_leaf}}
                        {{#each this.dom.catalogs}}
                            <span class="label label-default">{{this}}</span>
                        {{/each}}
                        {{/if}}
                    </div>

                    <div class="col-xs-4 text-right">
                        {{#if is_leaf}}
                        <small class="text-muted" title="{{this.stat.mtime}}">
                            {{timeago this.stat.mtime}}
                        </small>
                        {{/if}}
                    </div>
                </div>
            </a>
            {{/each}}
        </div>



        {{#unless session_get 'results_length'}}
        <div class="panel panel-default">
            <div class="panel-body">
                {{#if session_get 'repo_filter'}}
                Nothing in your repo matches
                <strong> {{session_get 'repo_filter'}}</strong>
                {{/if}}
                {{#unless session_get 'repo_filter'}}
                Weird, there doesn't seem to be any data here. o_0
                {{/unless}}
            </div>
        </div>
        {{/unless}}

    </div>

    <div class="col-lg-4">

        {{#if readme}}
        <div class="panel panel-default">
            <div class="panel-heading">
                <h5><i class="fa fa-file-text"></i> README.md</h5>
            </div>
            <div class="panel-body">
                {{#markdown}}{{readme}}{{/markdown}}
            </div>
        </div>
        {{/if}}
    </div>

</div>
</template>
